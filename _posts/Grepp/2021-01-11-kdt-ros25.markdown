---
layout: post
title:  "카메라 센서 장치"
date:   2021-01-11 01:00:00 +0900
categories: "Grepp/KDT"
---

## 자이카에 장착된 하드웨어 장치

- IMU 센서(자이로, 가속도, 나침반)
- 카메라
- 라이다 센서
- 초음파 센서
- 구동 모터(전/후진)
- 서보 모터(핸들 조작)
- 메인 프로세서(자율주행 SW 구동)



## 카메라 센서

- 1080P USB 카메라
- USB 2.0
- UVC 지원
    - USB Video Class: PC에 장착하면 별도 드라이브 설치 없이 사용 가능
- 170도 어안렌즈
    - 魚眼렌즈: 물고기 눈처럼 볼로 튀어나온 렌즈, 굉장히 넓은 시야각을 자랑하지만 가장자리 부근에 휘어지면서 왜곡이 생긴다. OpenCV로 간단하게 보정이 가능하다.
- CMOS OV2710 Senser
    - CCD: 디지털 카메라에서 사용, 사진 작가들이 주로 사용하는 센서
    - CMOS: CCD보다는 화질이 낮지만, 저렴하고 전기를 적게 사용한다. 휴대폰에서 사용하는 센서이다.
- 120fps(640x480), 30fps(1920x1080, 1080 HD급)
    - 일반적인 영화가 24fps이므로 30fps가 버퍼링이 있을 것이라고 생각하면 안된다.



## RGB(Red, Green, Blue)

- 빛의 3원색: Red, Green, Blue
    - 다른 것을 섞어서 만들 수 없는 색, 원래 존재 해야 하는 색
    - 세상 모든 색은 Red, Green, Blue의 3가지 색상 요소로 분해 가능
    - ex. 노란색 = Red + Blue
    - 색의 3원색(ex. 물감)과 색의 3원색은 다름
  
- 그림/동영상 데이터
    - Red, Green, Blue, 각각의 색상을 1byte(8Bits)로 표현
    - ex. 밤색점(Pixel) = \| (Red)150 \| (Green) 50 \| (Blue) 00 \|
    - Full-HD 1920x1080 화면을 가득 채우는 그림의 크기 = 1920 x 1080 x 3bytes = 6Mytes



## 해상도, PPI, 화소수

1. 해상도

- 가로, 세로 점이 몇 개씩 있는가
- 1px에 RGB를 모두 비춰야 하므로, 만약 가로로 RGB가 나열되어 있다면 SD 기준으로 화소의 갯수는 1800x480이 된다.
- 한정된 공간에 화소를 집약해야 하므로, LCD 공정은 반도체 회사가 유리하게 작업할 수 있다.

| SD | HD | FHD | QHD | UHD |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 600x480 | 1280x720 | 1920x1080 | 2560x1440 | 3840x2160 |


{:start="2"}
2. PPI

- 가로, 세로 1인치 정사각형에 몇 개의 화소가 들어가는가.
- 같은 해상도라도 화면이 작을 수록 PPI는 커지므로, 해상도와 PPI는 다른 의미를 가진다.


{:start="3"}
3. 화소수

- 해상도의 가로, 세로 화소수를 곱한 값



## 카메라 센서의 기능

1. 영상 촬영

- 연속된 사진을 찍어 이미지 파일로 전송
- Xycar의 최대 해상도 1920x1080 이지만, 640x480 사진을 초당 30장 촬영
    - 화소수: 640x480 = 30만
    - 사진 1장의 파일 크기: 화소수 30만 x 화소당 3Bytes = 90만 Bytes = 0.9MBytes = 7.2MBits
    - 초당 30장의 사진을 찍으므로, 1초 동안 전송되는 데이터 크기: 0.9MB x 30장 = 27MBytes = 216Mbits
    - 전송 속도: 216Mbps, USB 2.0의 최대 속도: 480Mbps이지만, 실제는 그 절반인 240Mbps
- 보통은 압축하여 전송하므로, 더 높은 해상도와 초당 더 많은 프레임 전송 가능
    - Xycar에서 640x480 사진을 초당 최대 120장까지 보낼 수 있음
    - 프로세스에서는 사진을 수신하면 압축을 풀어야 하는 부담이 있고, 이미 다른 작업들이 수행되고 있기 때문에, 너무 많은 사진을 보내는 것은 비효율적일 수 있다.

{:start="2"}
2. 노출도(Exposure): 주변 밝기에 따른 이미지 밝기 변화

- 의외로 어느정도 어두운 편이 영상처리로 차선을 인식하는데 유리하다.

{:start="3"}
3. 자동초점 조정(Auto-focus)

- 자율주행에서는 초점을 조정하는데 걸리는 시간동안 어떤 위험이 있을지 모르기 때문에, 보통은 Off한 상태로 작업한다.
